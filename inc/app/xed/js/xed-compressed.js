var xed_initial_value=new Array();var xed_path="";var xed_web_path="";var xed_prefix="";var xed_default_link="http://";var xed_site_url=location.protocol+"://"+location.host;var xed_site_domain=location.host;var xed_boxes=false;var xed_box_link="/index/boxchooser-app?";var xed_box_image="/pix/box.gif";var xed_forms=false;var xed_form_link="/index/formchooser-app?";var xed_form_image="/pix/form.gif";var xed_images_link="/index/xed-images-action?";var xed_images=true;var xed_spellchecker=false;var xed_scroller=false;var xed_scroller_data=false;var xed_preview_css="/inc/html/default/site.css";var xed_preview_insert_close=true;var xed_edit_mode="edit";var xed_edit_state="edit";var xed_source_positioned=false;var xed_agent=navigator.userAgent.toLowerCase();var xed_msie=((xed_agent.indexOf("msie")!=-1)&&(xed_agent.indexOf("opera")==-1));var xed_msie7=false;var xed_ff36=false;var xed_events=[];var xed_error_window=false;var xed_history=[];var xed_future=[];var xed_undo_max_length=12;var xed_prev_char=0;var xed_context_menu=false;var xed_mouse_x=0;var xed_mouse_y=0;var xed_max_height=false;var xed_max_width=false;var xed_img_popup=false;var xed_login_timer=0;var xed_rx_tag_name=/(<\/|<)\s*([^ \t\n>]+)/ig;var xed_selected=false;var xed_fullsize=false;var xed_debug_view=false;var xed_selected_node=null;var xed_rpc=new rpc();var xed_loading_ifname=null;function xed_do_nothing(g){}function xed_init(m){try{xed_initial_value[m]=decodeURIComponent(xed_initial_value[m])}catch(q){xed_initial_value[m]=unescape(xed_initial_value[m])}try{xed_scroller_data=decodeURIComponent(xed_scroller_data)}catch(q){xed_scroller_data=unescape(xed_scroller_data)}for(var l=0;l<xed_templates.length;l++){try{xed_templates[l]=decodeURIComponent(xed_templates[l])}catch(q){xed_templates[l]=unescape(xed_templates[l])}}q=document.getElementById(m);q.contentWindow.document.designMode="on";if(xed_safari){q.contentWindow.document.execCommand("styleWithCSS",false,false)}else{if(!xed_msie){try{q.contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){q.contentWindow.document.execCommand("useCSS",false,"")}}}if(xed_msie7&&xed_initial_value[m].length==0){xed_initial_value[m]="<p>Enter your content here.</p>"}if(xed_initial_value[m].length>0){try{q.contentWindow.document.body.innerHTML=xed_initial_value[m]}catch(g){if(xed_initial_value[m].match(/^<xt:/i)||xed_initial_value[m].match(/^<p><xt:/i)||xed_initial_value[m].match(/^<p><\/p><xt:/i)){xed_initial_value[m]=" <br />"+xed_initial_value[m]}q.contentWindow.document.write(xed_initial_value[m]);links=q.contentWindow.document.getElementsByTagName("a");winhref=window.location.href;if(winhref.indexOf("#")!=-1){arr=winhref.split("#");winhref=arr.shift()}for(l=0;l<links.length;l++){if(links[l].href.indexOf(winhref+"#")!=-1){arr=links[l].href.split("#");links[l].href="#"+arr.pop()}}xed_loading_ifname=m;window.setTimeout(function(){html=xed_get_source(xed_loading_ifname);html=html.replace(/><\/xt:(box|form)>/ig,">").replace(/<\/xt:(box|form) \/>/ig,"</xt:$1>");xed_set_source(xed_loading_ifname,html)},10)}}if(xed_fullsize){width=screen.availWidth-100;if(width>1000){width=1000}height=screen.availHeight-250;q.style.width=width;q.style.height=height}q=document.getElementById(m);q.contentWindow.document.designMode="off";q.contentWindow.document.designMode="on";if(xed_safari){q.contentWindow.document.execCommand("styleWithCSS",false,false)}else{if(!xed_msie){try{q.contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){q.contentWindow.document.execCommand("useCSS",false,"")}}}xed_add_events(q.contentWindow.document,["keydown","keypress","mousedown","mouseup","drag","focus","mousemove"],xed_event);if(xed_adobeair){q.contentWindow.document.addEventListener("click",function(u){if(u.srcElement.nodeName.toLowerCase()=="a"){u.preventDefault()}},true)}q.contentWindow.document.ifname=m;xed_login_timer=setInterval("rpc_call (xed_web_path + '/index/xed-notimeout-action');",900000);if(xed_scroller){scroller_init("xed-"+m+"-reference",m);r=document.getElementById("xed-"+m+"-reference");try{r.contentWindow.document.body.innerHTML=xed_scroller_data}catch(g){r.contentWindow.document.write(s.value)}}}function xed_copy_value(l,g){html=xed_get_source(g);l.elements[g].value=html}function xed_preview(g){p=window.open("about:blank","xedPreviewWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,fullscreen=no,width=500,height=400,top=100,left=150");if(xed_preview_css.length>0){p.document.write('<link rel="stylesheet" type="text/css" href="'+xed_preview_css+'" />')}p.document.write(xed_get_source(g));if(xed_preview_insert_close){p.document.write('<p align="center"><a href="javascript: window.close ()"><strong>Close Window</strong></a></p>')}return false}function xed_write_to_element(l,g){document.getElementById(g).innerHTML=xed_html_entities(xed_get_source(l));return false}function xed_safari_fix(g){if(!xed_safari){return false}html=xed_get_source(g);html=html.replace(/<span class="Apple-style-span" style="font-weight: bold; ?">([^<]+)<\/span>/g,"<strong>$1</strong>");html=html.replace(/<span class="Apple-style-span" style="font-style: italic; ?">([^<]+)<\/span>/g,"<em>$1</em>");html=html.replace(/<span class="Apple-style-span" style="text-decoration: underline; ?">([^<]+)<\/span>/g,"<u>$1</u>");html=html.replace(/<span class="Apple-style-span" style="vertical-align: sub; ?">([^<]+)<\/span>/g,"<sub>$1</sub>");html=html.replace(/<span class="Apple-style-span" style="vertical-align: super; ?">([^<]+)<\/span>/g,"<sup>$1</sup>");xed_set_source(g,html)}function xed_bold(l){xed_historian(l);if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById(l).contentWindow.document.execCommand("Bold",false,null);xed_safari_fix(l);document.getElementById(l).contentWindow.focus();return false}function xed_italic(l){xed_historian(l);if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById(l).contentWindow.document.execCommand("Italic",false,null);xed_safari_fix(l);document.getElementById(l).contentWindow.focus();return false}function xed_horizontal_rule(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("InsertHorizontalRule",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_underline(l){xed_historian(l);if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById(l).contentWindow.document.execCommand("Underline",false,null);xed_safari_fix(l);document.getElementById(l).contentWindow.focus();return false}function xed_align_left(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("JustifyLeft",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_align_right(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("JustifyRight",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_align_center(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("JustifyCenter",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_unordered_list(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("InsertUnorderedList",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_ordered_list(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("InsertOrderedList",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_indent(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("Indent",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_outdent(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("Outdent",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_link(g){n=xed_get_parent(g);if(n.tagName.toLowerCase()=="a"){xed_select_node(g,n);return xed_unlink(g)}if(xed_msie){h=350}else{h=300}w=window.open(xed_web_path+"/index/xed-link-form?ifname="+g,"xedLinkWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=580,height="+h+",top=100,left=150");return false}function xed_add_link(l,g){xed_historian(l);if(xed_get_selection(l)==""){n=xed_get_parent(l);xed_select_node(l,n)}xed_insert_element(l,"a",g);document.getElementById(l).contentWindow.focus()}function xed_unlink(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("Unlink",false,null);document.getElementById(g).contentWindow.focus();return false}function xed_image(ifname){eval("imagechooser_"+ifname+"_attrs = true");eval("imagechooser_"+ifname+"_get_image (ifname)");return false}function xed_set_image(m,u,q,A,l,g){xed_historian(m);e=document.getElementById(m);if(xed_max_height<l||xed_max_width<g){hw_resized=true;if(l>g){g=g*(xed_max_height/l);l=xed_max_height}else{l=l*(xed_max_width/g);g=xed_max_width}}else{hw_resized=false}if(document.all){img="";if(hw_resized&&xed_img_popup){img+='<a href="'+u+'" target="_blank">'}img+='<img src="'+u+'" alt="'+q+'"';if(l!=false&&g!=false){img=img+' height="'+l+'" width="'+g+'"'}if(A!=false){img=img+' align="'+A+'"'}img=img+' border="0" />';if(hw_resized&&xed_img_popup){img+="</a>"}document.getElementById(m).contentWindow.focus()}else{img=e.contentWindow.document.createElement("img");img.setAttribute("src",u);if(l!=false&&g!=false){img.setAttribute("height",l);img.setAttribute("width",g)}if(A!=false){img.setAttribute("align",A)}img.setAttribute("alt",q);img.setAttribute("border",0);if(hw_resized&&xed_img_popup){img_inner=img;img=e.contentWindow.document.createElement("a");img.setAttribute("href",u);img.setAttribute("target","_blank");img.appendChild(img_inner)}}xed_insert_node_at_selection(e.contentWindow,img);document.getElementById(m).contentWindow.focus()}function xed_clean(g){w=window.open("about:blank","xedCleanersWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=300,height=100,top=100,left=150");f=document.forms[0];xed_copy_value(f,g);t=f.target;a=f.action;f.target="xedCleanersWindow";f.action=xed_prefix+"/index/xed-cleaners-action?ifname="+g;f.submit();f.target=t;f.action=a;return false}function xed_cleaner(g,l){xed_historian(g);document.getElementById(g).contentWindow.document.body.innerHTML=unescape(l);return false}function xed_filechooser(g){filechooser_attrs=true;filechooser_get_file(g);return false}function xed_set_file(l,m,g){xed_historian(l);e=document.getElementById(l);if(document.all){arr=m.split("?file=");g=arr.pop();txt="";if(window.getSelection){txt=e.contentWindow.getSelection();e.contentWindow.selection.clear()}else{if(document.getSelection){txt=e.contentWindow.document.getSelection();e.contentWindow.document.selection.clear()}else{if(document.selection){txt=e.contentWindow.document.selection.createRange().text;e.contentWindow.document.selection.clear()}}}if(txt.length==0){txt=g}file='<a href="'+m+'">'+txt+"</a>"}else{file=e.contentWindow.document.createElement("a");file.setAttribute("href",m);txt="";if(window.getSelection){txt=e.contentWindow.getSelection()}else{if(document.getSelection){txt=e.contentWindow.document.getSelection()}else{if(document.selection){txt=e.contentWindow.document.selection.createRange().text}}}if(txt.length==0){txt=g}txt=e.contentWindow.document.createTextNode(txt);file.appendChild(txt)}document.getElementById(l).contentWindow.focus();xed_insert_node_at_selection(e.contentWindow,file);document.getElementById(l).contentWindow.focus()}function xed_select(l,m){xed_historian(l);c1=document.getElementById(m).selectedIndex;var g=document.getElementById(m).options[c1].value;if(g.length==0){g="<p>"}if(g=="<pre>"){xed_insert_pre(l)}else{document.getElementById(l).contentWindow.document.execCommand("formatblock",false,g);document.getElementById(m).selectedIndex=0}document.getElementById(l).contentWindow.focus();return false}function xed_table(g){w=window.open(xed_web_path+"/index/xed-tablesizer-action?ifname="+g,"xedTableWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=300,height=300,top=100,left=150");return false}function xed_insert_table(l,g){xed_historian(l);ch=g.split("x");rows=ch.shift();cols=ch.shift();e=document.getElementById(l);if(document.all){table='<table border="2" cellpadding="5" cellspacing="2" width="98%">';for(i=0;i<rows;i++){table=table+"\n\t<tr>";for(j=0;j<cols;j++){table=table+'\n\t\t<td border="2" valign="top"><br /></td>'}table=table+"\n\t</tr>"}table=table+"\n</table>\n"}else{table=e.contentWindow.document.createElement("table");table.setAttribute("width","98%");for(i=0;i<rows;i++){row=e.contentWindow.document.createElement("tr");for(j=0;j<cols;j++){col=e.contentWindow.document.createElement("td");col.setAttribute("valign","top");br=e.contentWindow.document.createElement("br");col.appendChild(br);row.appendChild(col)}table.appendChild(row)}table.appendChild(tbody)}document.getElementById(l).contentWindow.focus();xed_insert_node_at_selection(e.contentWindow,table);return false}function xed_table_cellspan(q){try{var g=q.colSpan==""?1:parseInt(q.colSpan);var m=q.rowSpan==""?1:parseInt(q.rowSpan);return{colspan:g,rowspan:m}}catch(l){return{colspan:1,rowspan:1}}}function xed_table_grid(l){var g=new Array();if(xed_msie){for(i=0;i<l.rows.length;i++){cur=l.rows[i];for(x=0;x<cur.cells.length;x++){td=cur.cells[x];sd=xed_table_cellspan(td);for(y=x;g[i]&&g[i][y];y++){}for(i2=i;i2<i+sd.rowspan;i2++){if(!g[i2]){g[i2]=new Array()}for(y2=y;y2<y+sd.colspan;y2++){g[i2][y2]=td}}}}return g}for(i=0;i<l.childNodes.length;i++){cur=l.childNodes[i];if(cur.tagName&&cur.tagName.toLowerCase()=="tbody"){for(x=0;x<cur.childNodes.length;x++){if(cur.childNodes[x].tagName&&cur.childNodes[x].tagName.toLowerCase()=="tr"){tr=cur.childNodes[x];for(y=0;y<tr.childNodes.length;y++){if(tr.childNodes[y].tagName&&tr.childNodes[y].tagName.toLowerCase()=="td"){td=tr.childNodes[y];sd=xed_table_cellspan(td);for(z=x;g[i]&&g[i][z];z++){}for(i2=i;i2<i+sd.rowspan;i2++){if(!g[i2]){g[i2]=new Array()}for(z2=z;z2<z+sd.colspan;z2++){g[i2][z2]=td}}}}}}}else{if(cur.tagName&&cur.tagName.toLowerCase()=="tr"){for(x=0;x<cur.childNodes.length;x++){if(cur.childNodes[x].tagName&&cur.childNodes[x].tagName.toLowerCase()=="td"){td=cur.childNodes[x];sd=xed_table_cellspan(td);for(y=x;g[i]&&g[i][y];y++){}for(i2=i;i2<i+sd.rowspan;i2++){if(!g[i2]){g[i2]=new Array()}for(y2=y;y2<y+sd.colspan;y2++){g[i2][y2]=td}}}}}}}return g}function xed_table_cellpos(l,q){var m,g;for(m=0;m<l.length;m++){for(g=0;g<l[m].length;g++){if(l[m][g]==q){return{cellindex:g,rowindex:m}}}}return null}function xed_table_get_cell(l,m,g){if(l[m]&&l[m][g]){return l[m][g]}return null}function xed_table_add_rows(A,q,u){xed_historian(ifname);ifname=xed_get_ifname(A);e=document.getElementById(ifname);A.rowSpan=1;var g=xed_get_next_element(q);for(var m=1;m<u&&g;m++){var l=e.contentWindow.document.createElement("td");l.innerHTML="<br />";if(xed_msie){g.insertBefore(l,g.cells(A.cellIndex))}else{g.insertBefore(l,g.cells[A.cellIndex])}g=xed_get_next_element(g)}}function xed_table_row_before(m){xed_historian(m);var g=xed_get_ancestors(m);var q=null;var l=null;for(i=0;i<g.length;i++){el=g[i];if(!el){continue}if(el.tagName.toLowerCase()=="tr"){q=el}else{if(el.tagName.toLowerCase()=="table"||el.tagName.toLowerCase()=="tbody"){l=el;break}}}if(xed_msie){new_tr=l.insertRow(q.rowIndex);for(i=0;i<q.cells.length;i++){new_td=new_tr.insertCell(-1);new_td.innerHTML="<br />";new_td.colSpan=q.cells[i].colSpan}return}e=document.getElementById(m);new_tr=e.contentWindow.document.createElement("tr");for(i=0;i<q.cells.length;i++){td=e.contentWindow.document.createElement("td");td.innerHTML="<br />";td.colSpan=q.cells[i].colSpan;new_tr.appendChild(td)}q.parentNode.insertBefore(new_tr,q)}function xed_table_row_after(m){xed_historian(m);var g=xed_get_ancestors(m);var q=null;var l=null;for(i=0;i<g.length;i++){el=g[i];if(!el){continue}if(el.tagName.toLowerCase()=="tr"){q=el}else{if(el.tagName.toLowerCase()=="table"||el.tagName.toLowerCase()=="tbody"){l=el;break}}}if(xed_msie){next=xed_get_next_element(q);new_tr=l.insertRow(next.rowIndex);for(i=0;i<q.cells.length;i++){new_td=new_tr.insertCell(-1);new_td.innerHTML="<br />";new_td.colSpan=q.cells[i].colSpan}return}e=document.getElementById(m);new_tr=e.contentWindow.document.createElement("tr");for(i=0;i<q.cells.length;i++){td=e.contentWindow.document.createElement("td");td.innerHTML="<br />";td.colSpan=q.cells[i].colSpan;new_tr.appendChild(td)}next=xed_get_next_element(q);if(next){next.parentNode.insertBefore(new_tr,next)}else{q.parentNode.appendChild(new_tr)}}function xed_table_row_delete(q){xed_historian(q);var l=xed_get_ancestors(q);var u=null;var m=null;for(var g=l.length;--g>=0;){el=l[g];if(!el){continue}if(el.tagName.toLowerCase()=="tr"){u=el}else{if(el.tagName.toLowerCase()=="table"){m=el}}}u.parentNode.removeChild(u)}function xed_table_col_before(m){xed_historian(m);var D=xed_get_ancestors(m);var l=null;var C=null;for(var q=D.length;--q>=0;){el=D[q];if(!el){continue}if(el.tagName.toLowerCase()=="td"){l=el}else{if(el.tagName.toLowerCase()=="table"){C=el}}}var g=xed_table_grid(C);var A=xed_table_cellpos(g,l);var B=null;if(xed_msie){for(var u=0;u<g.length;u++){l=xed_table_get_cell(g,u,A.cellindex);if(l!=B){sd=xed_table_cellspan(l);if(sd.colspan==1){new_td=l.parentNode.insertCell(A.cellindex);new_td.innerHTML="<br />";new_td.rowSpan=l.rowSpan}else{l.colSpan++}B=l}}return}for(var u=0;l=xed_table_get_cell(g,u,A.cellindex);u++){if(l!=B){sd=xed_table_cellspan(l);if(sd.colspan==1){new_td=document.getElementById(m).contentWindow.document.createElement(l.nodeName);new_td.innerHTML="<br />";new_td.rowSpan=l.rowSpan;l.parentNode.insertBefore(new_td,l)}else{l.colSpan++}B=l}}}function xed_table_col_after(m){xed_historian(m);var D=xed_get_ancestors(m);var l=null;var C=null;for(var q=D.length;--q>=0;){el=D[q];if(!el){continue}if(el.tagName.toLowerCase()=="td"){l=el}else{if(el.tagName.toLowerCase()=="table"){C=el}}}var g=xed_table_grid(C);var A=xed_table_cellpos(g,l);var B=null;if(xed_msie){for(var u=0;u<g.length;u++){l=xed_table_get_cell(g,u,A.cellindex);if(l!=B){sd=xed_table_cellspan(l);if(sd.colspan==1){next=xed_get_next_element(l);npos=xed_table_cellpos(g,next);new_td=l.parentNode.insertCell(npos.cellindex);new_td.innerHTML="<br />";new_td.rowSpan=l.rowSpan}else{l.colSpan++}B=l}}return}for(var u=0;l=xed_table_get_cell(g,u,A.cellindex);u++){if(l!=B){sd=xed_table_cellspan(l);if(sd.colspan==1){new_td=document.getElementById(m).contentWindow.document.createElement(l.nodeName);new_td.innerHTML="<br />";new_td.rowSpan=l.rowSpan;next=xed_get_next_element(l);if(next){next.parentNode.insertBefore(new_td,next)}else{l.parentNode.appendChild(new_td)}}else{l.colSpan++}B=l}}}function xed_table_col_delete(u){xed_historian(u);var m=xed_get_ancestors(u);var C=null;var q=null;for(var l=m.length;--l>=0;){el=m[l];if(!el){continue}if(el.tagName.toLowerCase()=="td"){C=el}else{if(el.tagName.toLowerCase()=="table"){q=el}}}var g=xed_table_grid(q);var B=xed_table_cellpos(g,C);for(var A=0;C=xed_table_get_cell(g,A,B.cellindex);A++){C.parentNode.removeChild(C)}}function xed_table_merge(V){xed_historian(V);var O=new Array();var T=xed_get_selection(V);var q=xed_get_ancestors(V);var K=null;var u=null;var Y=null;for(var U=q.length;--U>=0;){el=q[U];if(!el){continue}if(el.tagName.toLowerCase()=="td"){K=el}else{if(el.tagName.toLowerCase()=="tr"){u=el}else{if(el.tagName.toLowerCase()=="table"){Y=el}}}}var l=xed_table_grid(Y);if(xed_msie||T.rangeCount==1){if(!K){if(!u){return}K=u.cells[0]}var R=xed_get_next_element(K);K.colSpan=K.colSpan+R.colSpan;R.parentNode.deleteCell(R.cellIndex);return}else{var E=new Array();var T=xed_get_selection(V);var F=null;var Z=null;var X=-1,C=-1,W,B;if(T.rangeCount<2){return true}for(var U=0;U<T.rangeCount;U++){var I=T.getRangeAt(U);var K=I.startContainer.childNodes[I.startOffset];if(!K){break}if(K.nodeName.toLowerCase()=="td"){E[E.length]=K}}var G=l;for(var M=0;M<G.length;M++){var H=new Array();for(var N=0;N<G[M].length;N++){var K=G[M][N];for(var U=0;U<E.length;U++){if(K==E[U]){H[H.length]=K}}}if(H.length>0){O[O.length]=H}}var Z=new Array();var F=null;for(var M=0;M<l.length;M++){for(var N=0;N<l[M].length;N++){l[M][N]._selected=false;for(var U=0;U<E.length;U++){if(l[M][N]==E[U]){if(X==-1){X=N;C=M}W=N;B=M;l[M][N]._selected=true}}}}for(var M=C;M<=B;M++){for(var N=X;N<=W;N++){if(!l[M][N]._selected){alert("You can only merge cells horizontally.");return true}}}}var D=1,J=1;var ab=-1;for(var M=0;M<O.length;M++){var L=0;for(var N=0;N<O[M].length;N++){var g=xed_table_cellspan(O[M][N]);L+=g.colspan;if(ab!=-1&&g.rowspan!=ab){alert("You can only merge cells horizontally.");return true}ab=g.rowspan}if(L>J){J=L}ab=-1}var A=-1;for(var N=0;N<O[0].length;N++){var Q=0;for(var M=0;M<O.length;M++){var g=xed_table_cellspan(O[M][N]);Q+=g.rowspan;if(A!=-1&&g.colspan!=A){alert("You can only merge cells horizontally.");return true}A=g.colspan}if(Q>D){D=Q}A=-1}K=O[0][0];K.rowSpan=D;K.colSpan=J;for(var M=0;M<O.length;M++){for(var N=0;N<O[M].length;N++){var P=O[M][N].innerHTML;var aa=P.replace(new RegExp("[ \t\r\n]","g"),"");if(aa!="<br/>"&&aa!="<br>"&&aa!="&nbsp;"&&(N+M>0)){K.innerHTML+=P}if(O[M][N]!=K&&!O[M][N]._deleted){var m=xed_table_cellpos(l,O[M][N]);var u=O[M][N].parentNode;u.removeChild(O[M][N]);O[M][N]._deleted=true;if(!u.hasChildNodes()){u.parentNode.removeChild(u);var S=null;for(var N=0;cell=xed_table_get_cell(l,m.rowindex,N);N++){if(cell!=last_cell&&cell.rowSpan>1){cell.rowSpan--}last_cell=cell}if(K.rowSpan>1){K.rowSpan--}}}}}}function xed_table_split_merged(q){xed_historian(q);var m=xed_get_ancestors(q);var C=null;for(l=0;l<m.length;l++){el=m[l];if(!el){continue}if(el.tagName.toLowerCase()=="td"){C=el;break}}var A=xed_table_cellspan(C);var B=A.colspan;var u=A.rowspan;if(B>1||u>1){C.colSpan=1;for(var l=1;l<B;l++){var g=doc.createElement("td");g.innerHTML="<br />";C.parentNode.insertBefore(g,xed_get_next_element(C));if(u>1){xed_table_add_rows(g,C.parentNode,u)}}xed_table_add_rows(C,C.parentNode,u)}}function xed_insert_element(m,l,g){xed_historian(m);e=document.getElementById(m);d=e.contentWindow.document;for(i=0;i<g.length;i++){g[i].value=g[i].value.replace(/&amp;/g,"&")}if(document.all){tag="<"+l;for(i=0;i<g.length;i++){tag+=" "+g[i].name+' ="'+g[i].value+'"'}tag+=">";len=tag.length;sel=document.getElementById(m).contentWindow.document.selection;range=sel.createRange();inn=range.htmlText;while(inn.match(/^<([a-zA-Z0-9\:_-]+)[^>]*>/)){inn=inn.replace(/^<([a-zA-Z0-9\:_-]+)[^>]*>/,"")}while(inn.match(/<\/[^>]+>$/)){inn=inn.replace(/<\/[^>]+>$/,"")}tag+=inn;if(tag.length==len){empty=true;len2=0}else{empty=false;len2=inn.length*-1}tag+="</"+l+">";range.pasteHTML(tag);range.moveStart("character",len2);range.select()}else{if(xed_safari){tag="##STARTNEWELEMENT##";tag2="<"+l;for(i=0;i<g.length;i++){tag2+=" "+g[i].name+'="'+g[i].value+'"'}tag2+=">";tag_end="##ENDNEWELEMENT##";tag2_end="</"+l+">";sel=document.getElementById(m).contentWindow.getSelection();range=document.getElementById(m).contentWindow.document.createRange();range.setStart(sel.anchorNode,sel.anchorOffset);range.setEnd(sel.focusNode,sel.focusOffset);pre=sel.focusNode.data.substring(0,sel.focusOffset);post=sel.focusNode.data.substring(sel.focusOffset);sel.focusNode.data=pre+tag_end+post;pre=sel.anchorNode.data.substring(0,sel.anchorOffset);post=sel.anchorNode.data.substring(sel.anchorOffset);sel.anchorNode.data=pre+tag+post;html=xed_get_source(m);html=html.replace(/##STARTNEWELEMENT##/g,tag2);html=html.replace(/##ENDNEWELEMENT##/g,tag2_end);xed_set_source(m,html,true)}else{len=l.length+2;tag=d.createElement(l);for(i=0;i<g.length;i++){tag.setAttribute(g[i].name,g[i].value);len+=5+g[i].name.length+g[i].value.length}sel=xed_get_selection(m);range=sel.getRangeAt(0);inn=range.extractContents();tag.appendChild(inn);if(tag.innerHTML.length==0){empty=true}else{empty=false}xed_insert_node_at_selection(e.contentWindow,tag)}}e.contentWindow.focus();return false}function xed_insert_pre(g){xed_historian(g);name="pre";attrs=[];e=document.getElementById(g);d=e.contentWindow.document;if(document.all){tag="<"+name;for(i=0;i<attrs.length;i++){tag+=" "+attrs[i].name+' ="'+attrs[i].value+'"'}tag+=">";len=tag.length;sel=document.getElementById(g).contentWindow.document.selection;range=sel.createRange();inn=range.htmlText;while(inn.match(/<([a-zA-Z0-9\:_-]+)[^>]*>/)){inn=inn.replace(/<([a-zA-Z0-9\:_-]+)[^>]*>/,"")}while(inn.match(/<\/[^>]+>/)){inn=inn.replace(/<\/[^>]+>/,"")}tag+=inn;if(tag.length==len){empty=true;len2=0}else{empty=false;len2=inn.length*-1}tag+="</"+name+">";range.pasteHTML(tag);range.moveStart("character",len2);range.select()}else{len=name.length+2;tag=d.createElement(name);for(i=0;i<attrs.length;i++){tag.setAttribute(attrs[i].name,attrs[i].value);len+=5+attrs[i].name.length+attrs[i].value.length}sel=xed_get_selection(g);range=sel.getRangeAt(0);inn=range.extractContents();html=xed_get_html(inn,false,false);while(html.match(/<([a-zA-Z0-9\:_-]+)[^>]*>/)){html=html.replace(/<([a-zA-Z0-9\:_-]+)[^>]*>/,"")}while(html.match(/<\/[^>]+>/)){html=html.replace(/<\/[^>]+>/,"")}tag.appendChild(e.contentWindow.document.createTextNode(html));if(tag.innerHTML.length==0){empty=true}else{empty=false}xed_insert_node_at_selection(e.contentWindow,tag)}e.contentWindow.focus();return false}function xed_charmap(g){w=window.open(xed_web_path+"/index/xed-charmap-action?ifname="+g,"xedCharmapWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=480,height=250,top=100,left=150");return false}function xed_insert_character(g,l){xed_historian(g);if(document.all){sel=document.getElementById(g).contentWindow.document.selection;range=sel.createRange();range.cutHTML;range.pasteHTML("&#"+l+";")}else{xed_insert_html_at_selection(g,"&#"+l+";")}document.getElementById(g).contentWindow.focus();return false}function xed_edit_properties(l,g){if(!g){g=xed_get_parent(l)}if(g.tagName.toLowerCase()=="tbody"){g=g.parentNode}if(xed_msie&&g.tagName.toLowerCase()=="box"){tag_name="xt:box"}else{tag_name=g.tagName.toLowerCase()}p="?ifname="+l+"&tag="+tag_name;for(i=0;i<g.attributes.length;i++){p+="&"+g.attributes[i].name+"="+xed_url_encode(g.attributes[i].value)}w=window.open(xed_web_path+"/index/xed-properties-action"+p,"xedEditProperties","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=580,height=400,top=100,left=150");return false}function xed_word_importer(g){w=window.open(xed_web_path+"/index/xed-importer-form?ifname="+g,"XedWordImporter","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=480,height=250,top=100,left=150");return false}function xed_word_importer_return(l,g){xed_historian(l);xed_insert_html_at_selection(l,g);document.getElementById(l).contentWindow.focus()}function xed_set_properties(g,l){xed_historian(g);element=xed_get_parent(g);if(element.tagName.toLowerCase()=="tbody"){element=element.parentNode}for(i=0;i<element.attributes.length;i++){if(xed_msie){if(element.tagName.toLowerCase()=="box"&&element.attributes[i].name=="style"){continue}element.removeAttribute(element.attributes[i].name)}else{element.setAttribute(element.attributes[i].name,null)}}if(element.tagName.toLowerCase()=="xt:box"||(xed_msie&&element.tagName.toLowerCase()=="box")){inner="";sep=" (";for(i=0;i<l.length;i++){l[i].value=l[i].value.replace(/&amp;/g,"&");element.setAttribute(l[i].name,l[i].value);if(l[i].name=="name"){inner+=l[i].value}else{if(l[i].name!="style"&&l[i].name!="title"){inner+=sep+l[i].name+"="+l[i].value;sep=", "}}}if(l.length>1){inner+=")"}element.innerHTML=inner}else{for(i=0;i<l.length;i++){l[i].value=l[i].value.replace(/&amp;/g,"&");element.setAttribute(l[i].name,l[i].value)}}document.getElementById(g).contentWindow.focus();return false}function xed_superscript(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("superscript",false,null);xed_safari_fix(g);document.getElementById(g).contentWindow.focus();return false}function xed_subscript(g){xed_historian(g);document.getElementById(g).contentWindow.document.execCommand("subscript",false,null);xed_safari_fix(g);document.getElementById(g).contentWindow.focus();return false}function xed_historian(g){s=xed_get_source(g);if(xed_history.length==0||s!=xed_history[xed_history.length-1]){xed_history.push(s)}while(xed_history.length>xed_undo_max_length){xed_history.shift()}while(xed_future.length>xed_undo_max_length){xed_future.shift()}xed_debug(xed_history.length+"|"+xed_future.length)}function xed_show_history(g){o="";for(i=0;i<xed_history.length;i++){o+=i+". "+xed_history[i]+"\n"}o+="----------\n";for(i=0;i<xed_future.length;i++){o+=i+". "+xed_future[i]+"\n"}alert(o);document.getElementById(g).contentWindow.focus();return false}function xed_undo(g){if(xed_history.length>0){c=xed_get_source(g);s=xed_history.pop();while(c==s){t=s;s=xed_history.pop();if(s==null){s=t;break}}xed_future.push(c);document.getElementById(g).contentWindow.document.body.innerHTML=s}document.getElementById(g).contentWindow.focus();return false}function xed_redo(g){if(xed_future.length>0){c=xed_get_source(g);s=xed_future.pop();while(c==s){t=s;s=xed_future.pop();if(s==null){s=t;break}}xed_history.push(c);document.getElementById(g).contentWindow.document.body.innerHTML=s}document.getElementById(g).contentWindow.focus();return false}function xed_cut(g){try{document.getElementById(g).contentWindow.document.execCommand("cut",false,null)}catch(l){if(confirm("Due to limitations in the Mozilla browser, ordinary scripts cannot access the clipboard.  Click OK to see a technical note at mozilla.org which shows you how to allow a script to access the clipboard.")){window.open("http://mozilla.org/editor/midasdemo/securityprefs.html")}}document.getElementById(g).contentWindow.focus();return false}function xed_copy(g){try{document.getElementById(g).contentWindow.document.execCommand("copy",false,null)}catch(l){if(confirm("Due to limitations in the Mozilla browser, ordinary scripts cannot access the clipboard.  Click OK to see a technical note at mozilla.org which shows you how to allow a script to access the clipboard.")){window.open("http://mozilla.org/editor/midasdemo/securityprefs.html")}}document.getElementById(g).contentWindow.focus();return false}function xed_paste(g){try{document.getElementById(g).contentWindow.document.execCommand("paste",false,null)}catch(l){if(confirm("Due to limitations in the Mozilla browser, ordinary scripts cannot access the clipboard.  Click OK to see a technical note at mozilla.org which shows you how to allow a script to access the clipboard.")){window.open("http://mozilla.org/editor/midasdemo/securityprefs.html")}}document.getElementById(g).contentWindow.focus();return false}function xed_help(g){window.open(xed_web_path+"/index/help-app?appname=xed","xedHelpWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,fullscreen=no,width=640,height=480,top=100,left=150");return false}function xed_full_screen(g){width=750;height=550;width=screen.availWidth-50;height=screen.availHeight-75;if(width>1050){width=1050}w=window.open("","xedFullscreenWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width="+width+",height="+height+",top=25,left=25");f=document.getElementById("xed-"+g+"-fsform");f.elements.xeditor.value=xed_get_source(g);f.submit();return false}function xed_template(m,l){xed_historian(m);c1=document.getElementById(l).selectedIndex;if(c1!=0){var g=document.getElementById(l).options[c1].value;document.getElementById(l).selectedIndex=0;if(g==""){}else{if(g=="ADD TEMPLATE"){var u=m;var q=l;prompt("Please enter a name for your template","",function(A){if(A==false||A==null||A.length==0){return}value=xed_get_source(u);rpc_call(xed_web_path+"/index/xed-template-add-action?name="+A+"&body="+xed_url_encode(value));tlist=document.getElementById(q);for(i=0;i<tlist.options.length;i++){if(tlist.options[i].text==A){xed_templates[tlist.options[i].value]=value;num=tlist.options[i].value;break}if(tlist.options[i].value=="ADD TEMPLATE"){xed_templates.push(value);num=xed_templates.length-1;if(document.all){tmp=tlist.options[i];tlist.options.remove(i);tlist.options[i]=new Option(A,num,false,true);tlist.options[i+1]=tmp;tlist.selectedIndex=0}else{tmp=tlist.options[i];tlist.options[i]=null;o=document.createElement("option");o.text=A;o.value=num;tlist.add(o,null);tlist.add(tmp,null)}break}}})}else{xed_insert_html_at_selection(m,xed_html_entities_decode(xed_templates[g]))}}}return false}function xed_attribute(g,l){obj=new Object();obj.name=g;obj.value=l;return obj}function xed_create_box(ifname){if(xed_msie){document.getElementById(ifname).contentWindow.focus()}eval("boxchooser_"+ifname+"_get_file (ifname)");return false}function xed_insert_box(m,l,q,g){xed_historian(m);e=document.getElementById(m);if(document.all){box='<xt:box name="'+l+'" title="'+l+'" style="word-wrap: break-word; display: list-item; list-style-type: none; background-color: #b7c3cf; -moz-border-radius: 10px; min-height: 20px; width: 575px; font-weight: normal; padding: 15px 15px 15px 15px; margin: 5px;"';if(g.length>0){for(i=0;i<g.length;i++){g[i].value=unescape(g[i].value);box=box+" "+g[i].name+'="'+g[i].value+'"'}}box=box+">";txt=l;if(g.length>0){txt+=" (";sep="";for(i=0;i<g.length;i++){txt+=sep+g[i].name+"="+g[i].value;sep=", "}txt+=")"}box=box+txt+"</xt:box>"}else{box=e.contentWindow.document.createElement("xt:box");box.setAttribute("name",l);box.setAttribute("title",l);box.setAttribute("style","word-wrap: break-word; display: list-item; list-style-type: none; background-color: #b7c3cf; -moz-border-radius: 10px; min-height: 20px; width: 575px; font-weight: normal; padding: 15px 15px 15px 15px; margin: 5px;");if(g.length>0){for(i=0;i<g.length;i++){g[i].value=unescape(g[i].value);box.setAttribute(g[i].name,g[i].value)}}txt=l;if(g.length>0){txt+=" (";sep="";for(i=0;i<g.length;i++){txt+=sep+g[i].name+"="+g[i].value;sep=", "}txt+=")"}box.appendChild(e.contentWindow.document.createTextNode(txt))}xed_insert_node_at_selection(e.contentWindow,box);document.getElementById(m).contentWindow.focus()}function xed_create_form(g){formchooser_get_file(g);return false}function xed_insert_form(m,l,q,g){xed_historian(m);e=document.getElementById(m);l=l.replace("/forms/","/");if(document.all){box='<xt:form name="'+l+'" title="'+l+'" style="word-wrap: break-word; display: list-item; list-style-type: none; background-color: #b7c3cf; -moz-border-radius: 10px; min-height: 20px; width: 575px; font-weight: normal; padding: 15px 15px 15px 15px; margin: 5px;"';if(g.length>0){for(i=0;i<g.length;i++){box=box+" "+g[i].name+'="'+g[i].value+'"'}}box=box+">";txt=l;if(g.length>0){txt+=" (";sep="";for(i=0;i<g.length;i++){txt+=sep+g[i].name+"="+g[i].value;sep=", "}txt+=")"}box=box+txt+"</xt:form>"}else{box=e.contentWindow.document.createElement("xt:form");box.setAttribute("name",l);box.setAttribute("title",l);box.setAttribute("style","display: list-item; list-style-type: none; background-color: #b7c3cf; -moz-border-radius: 10px; min-height: 20px; width: 575px; font-weight: normal; padding: 15px 15px 15px 15px; margin: 5px;");if(g.length>0){for(i=0;i<g.length;i++){box.setAttribute(g[i].name,g[i].value)}}txt=l;if(g.length>0){txt+=" (";sep="";for(i=0;i<g.length;i++){txt+=sep+g[i].name+"="+g[i].value;sep=", "}txt+=")"}box.appendChild(e.contentWindow.document.createTextNode(txt))}xed_insert_node_at_selection(e.contentWindow,box);document.getElementById(m).contentWindow.focus()}function xed_rtl(g){xed_historian(g);document.getElementById(g).contentWindow.document.body.style.direction="rtl";document.getElementById(g).contentWindow.focus();return false}function xed_ltr(g){xed_historian(g);document.getElementById(g).contentWindow.document.body.style.direction="ltr";document.getElementById(g).contentWindow.focus();return false}function xed_spell_checker(g){w=window.open(xed_web_path+"/index/xed-spell-pleasewait-action?ifname="+g+"&text="+xed_url_encode(xed_get_source(g)),"xedSpellWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=600,height=425,top=50,left=50");return false}function xed_set_source(m,l){if(arguments.length==3&&xed_safari){}else{xed_historian(m)}document.getElementById(m).contentWindow.document.body.innerHTML=xed_html_entities_decode(l);if(xed_msie){links=document.getElementById(m).contentWindow.document.getElementsByTagName("a");winhref=window.location.href;if(winhref.indexOf("#")!=-1){arr=winhref.split("#");winhref=arr.shift()}for(i=0;i<links.length;i++){if(links[i].href.indexOf(winhref+"#")!=-1){arr=links[i].href.split("#");links[i].href="#"+arr.pop()}}}document.getElementById(m).contentWindow.document.designMode="on";try{try{document.getElementById(m).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(m).contentWindow.document.execCommand("useCSS",false,"")}}catch(g){}document.getElementById(m).contentWindow.focus();return false}function xed_mode(l,m){if(xed_edit_mode==m){}html=xed_get_source(l);if(m=="source"){if(xed_msie){h=550}else{h=500}w=window.open(xed_web_path+"/index/xed-source-form?ifname="+l+"&html=","xedSourceWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,fullscreen=no,width=700,height="+h+",top=25,left=25");return false;p=new Prompter(function(u){if(u==null||u==undefined||u==false){document.getElementById(l).contentWindow.focus();return false}document.getElementById(l).contentWindow.document.body.innerHTML=u;if(xed_msie){links=document.getElementById(l).contentWindow.document.getElementsByTagName("a");winhref=window.location.href;if(winhref.indexOf("#")!=-1){arr=winhref.split("#");winhref=arr.shift()}for(i=0;i<links.length;i++){if(links[i].href.indexOf(winhref+"#")!=-1){arr=links[i].href.split("#");links[i].href="#"+arr.pop()}}}document.getElementById(l).contentWindow.document.designMode="on";if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(q){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById(l).contentWindow.focus()});p.type="textarea";p.cols=80;p.rows=30;p.width=700;p.height=550;p.open("Editing Source",html)}return false;if(m=="source"){document.getElementById("xed-"+l+"-edit-bar").style.visibility="hidden";document.getElementById("xed-"+l+"-path").style.visibility="hidden";document.getElementById("xed-"+l+"-source").style.display="inline";document.getElementById("xed-"+l+"-source").style.visibility="visible";document.getElementById("xed-"+l+"-source-bar").style.visibility="visible";if(!xed_source_positioned){s=document.getElementById("xed-"+l+"-source");b=document.getElementById("xed-"+l+"-source-bar");if(xed_scroller){s.style.left=s.offsetLeft-451}else{s.style.left=s.offsetLeft-662}s.style.marginTop=0;b.style.top=b.offsetTop-15;xed_source_positioned=true}document.getElementById("xed-"+l+"-source").value=html;document.getElementById("xed-"+l+"-mode-source-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-source-button").childNodes[0].style.color="09f";document.getElementById("xed-"+l+"-mode-source-button").childNodes[0].style.fontWeight="bold";document.getElementById("xed-"+l+"-mode-edit-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-edit-button").childNodes[0].style.color="d60";document.getElementById("xed-"+l+"-source").focus();xed_edit_state=m}else{if(m=="edit"){document.getElementById("xed-"+l+"-source").style.display="none";document.getElementById("xed-"+l+"-source").style.visibility="hidden";document.getElementById("xed-"+l+"-source-bar").style.visibility="hidden";document.getElementById("xed-"+l+"-mode-source-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-source-button").childNodes[0].style.color="d60";document.getElementById("xed-"+l+"-mode-edit-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-edit-button").childNodes[0].style.color="09f";document.getElementById("xed-"+l+"-mode-edit-button").childNodes[0].style.fontWeight="bold";document.getElementById("xed-"+l+"-edit-bar").style.visibility="visible";document.getElementById("xed-"+l+"-path").style.visibility="visible";document.getElementById(l).contentWindow.document.body.innerHTML=html;if(xed_msie){links=document.getElementById(l).contentWindow.document.getElementsByTagName("a");winhref=window.location.href;if(winhref.indexOf("#")!=-1){arr=winhref.split("#");winhref=arr.shift()}for(i=0;i<links.length;i++){if(links[i].href.indexOf(winhref+"#")!=-1){arr=links[i].href.split("#");links[i].href="#"+arr.pop()}}}document.getElementById(l).contentWindow.document.designMode="on";if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById(l).contentWindow.focus();xed_edit_state=m}else{if(m=="off"){document.getElementById("xed-"+l+"-edit-bar").style.visibility="hidden";document.getElementById("xed-"+l+"-formatblock").style.visibility="hidden";document.getElementById("xed-"+l+"-templatelist").style.visibility="hidden";document.getElementById("xed-"+l+"-path").style.visibility="hidden";document.getElementById("xed-"+l+"-source").style.display="none";document.getElementById("xed-"+l+"-source").style.visibility="hidden";document.getElementById("xed-"+l+"-source-bar").style.visibility="hidden"}else{if(m=="on"){document.getElementById(l).contentWindow.document.designMode="on";if(!xed_msie){try{document.getElementById(l).contentWindow.document.execCommand("styleWithCSS",false,false)}catch(g){document.getElementById(l).contentWindow.document.execCommand("useCSS",false,"")}}document.getElementById("xed-"+l+"-edit-bar").style.visibility="visible";document.getElementById("xed-"+l+"-formatblock").style.visibility="visible";document.getElementById("xed-"+l+"-templatelist").style.visibility="visible";document.getElementById("xed-"+l+"-path").style.visibility="visible";document.getElementById("xed-"+l+"-source").style.display="none";document.getElementById("xed-"+l+"-source").style.visibility="hidden";document.getElementById("xed-"+l+"-source-bar").style.visibility="hidden";document.getElementById("xed-"+l+"-mode-source-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-source-button").childNodes[0].style.color="d60";document.getElementById("xed-"+l+"-mode-edit-button").style.backgroundColor="#eee";document.getElementById("xed-"+l+"-mode-edit-button").childNodes[0].style.color="09f";document.getElementById("xed-"+l+"-mode-edit-button").childNodes[0].style.fontWeight="bold"}}}}xed_edit_mode=m;return false}function xed_toggle_context_menu(l,g){if(xed_context_menu){document.getElementById("xed-context-menu").style.display="none";document.getElementById("xed-context-menu-shade").style.display="none";xed_context_menu=false;return false}else{e=document.getElementById(l);menu=document.getElementById("xed-context-menu");shade=document.getElementById("xed-context-menu-shade");h=0;i=28;p=xed_get_parent(l);o="<ul>";o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_select_node_contents ('"+l+"', xed_get_parent ('"+l+'\')))"><img src="'+xed_web_path+'/inc/app/xed/pix/spacer.gif" alt="" border="0" /> <strong>Element: <span style="text-transform: lowercase">'+p.tagName+"</span></strong></a></li>";h+=i;if(p.tagName.toLowerCase()!="body"){o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_edit_properties ('"+l+"', xed_get_parent ('"+l+'\')))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/edit-properties-24x24.gif" alt="Edit Properties" title="Edit Properties" border="0" /> Edit Properties</a></li>';h+=i;o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_remove_element ('"+l+"', xed_get_parent ('"+l+'\')))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/remove-element-24x24.gif" alt="Remove Element" title="Remove Element" border="0" /> Remove Element</a></li>';h+=i;if(p.tagName.toLowerCase()!="a"){o+='<li class="xcm-sep"><a href="javascript: void xed_toggle_context_menu (\''+l+"', xed_link ('"+l+'\'))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/link.gif" alt="Make Link" title="Make Link" border="0" /> Make Link</a></li>';h+=i;o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_align_left ('"+l+'\'))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/align-left.gif" alt="Align Left" title="Align Left" border="0" /> Align Left</a></li>';h+=i}else{o+='<li class="xcm-sep"><a href="javascript: void xed_toggle_context_menu (\''+l+"', xed_align_left ('"+l+'\'))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/align-left.gif" alt="Align Left" title="Align Left" border="0" /> Align Left</a></li>';h+=i}o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_align_center ('"+l+'\'))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/align-center.gif" alt="Align Center" title="Align Center" border="0" /> Align Center</a></li>';h+=i;o+="<li><a href=\"javascript: void xed_toggle_context_menu ('"+l+"', xed_align_right ('"+l+'\'))"><img src="'+xed_web_path+'/inc/app/xed/pix/icons/align-right.gif" alt="Align Right" title="Align Right" border="0" /> Align Right</a></li>';h+=i}p=xed_get_element_pos(e);if(xed_msie){if(document.compatMode=="CSS1Compat"){menu.style.left=g.clientX+p.x;menu.style.top=g.clientY+p.y}else{menu.style.left=g.clientX+p.x;menu.style.top=g.clientY+p.y}}else{menu.style.left=g.pageX+p.x-e.contentWindow.scrollX;menu.style.top=g.pageY+p.y-e.contentWindow.scrollY}o+="</ul>";menu.style.height=h;menu.style.display="block";shade.style.left=parseInt(menu.style.left)+3;shade.style.top=parseInt(menu.style.top)+3;shade.style.height=menu.style.height;shade.style.display="block";xed_context_menu=true;menu.innerHTML=o;return false}}function xed_needs_closing_tag(g){var l=" head script style p div span tr td tbody table em strong font a title xt:box xt:form box form ";return(l.indexOf(" "+g.tagName.toLowerCase()+" ")!=-1)}function xed_is_block_tag(l){var g=" p h1 h2 h3 h4 h5 h6 table tr script style head body div td tbody xt:box xt:form box form hr blockquote pre ul ol li ";return(g.indexOf(" "+l+" ")!=-1)}function xed_get_element_pos(m){var l={x:m.offsetLeft,y:m.offsetTop};if(m.offsetParent){if(m.offsetParent==document.getElementById("cms-edit")){return l}var g=xed_get_element_pos(m.offsetParent);l.x+=g.x;l.y+=g.y}return l}function xed_get_next_element(g){name=g.nodeName.toLowerCase();while((g=g.nextSibling)!=null){if(g.nodeName.toLowerCase()==name){return g}}return null}function xed_in_array(g,l){for(i=0;i<g.length;i++){if(g[i].length>0&&xed_in_array(g[i],l)){return true}if(g[i]==l){return true}}return false}function xed_get_selection(l){try{return document.getElementById(l).contentWindow.getSelection()}catch(g){return document.getElementById(l).contentWindow.document.selection}}function xed_select_node_contents(m,l){var g;if(!xed_msie){var q=xed_get_selection(m);g=document.getElementById(m).contentWindow.document.createRange();g.selectNodeContents(l);q.removeAllRanges();q.addRange(g);if(xed_safari){xed_selected_node=l}}else{g=document.getElementById(m).contentWindow.document.body.createTextRange();g.moveToElementText(l);g.select()}tag=l.tagName.toLowerCase();document.getElementById(m).contentWindow.focus();xed_update_path(m,tag)}function xed_select_node(q,m){var g;try{var u=xed_get_selection(q);g=document.getElementById(q).contentWindow.document.createRange();g.selectNode(m);u.removeAllRanges();u.addRange(g);if(xed_safari){xed_selected_node=m}}catch(l){g=document.getElementById(q).contentWindow.document.body.createTextRange();g.moveToElementText(m);g.select()}}function xed_create_range(m,q){try{document.getElementById(m).contentWindow.focus();if(typeof q!="undefined"){return q.getRangeAt(0)}else{return document.getElementById(m).contentWindow.document.createRange()}}catch(g){if(typeof q!="undefined"){try{return q.createRange()}catch(l){return false}}else{return document.getElementById(m).contentWindow.document.body.createTextRange()}}}function xed_error(g){if(!xed_error_window||xed_error_window.closed){xed_error_window=window.open("","test","top=10,left=10,height=700,width=200")}xed_error_window.document.write(g+"<br />")}function xed_get_parent(m){if(arguments.length>1){xed_selected=arguments[1]}var q=xed_get_selection(m);var l=xed_create_range(m,q);if(!l){return}if(!xed_msie){if(xed_selected!="a"&&l.endContainer&&l.startContainer==l.endContainer&&l.startContainer.nodeType==1){var g=null;if(l.startContainer.tagName.toLowerCase()=="img"){g=l.startContainer}else{if(l.endOffset-l.startOffset==1&&l.startContainer.childNodes[l.startOffset].tagName.toLowerCase()=="img"){g=l.startContainer.childNodes[l.startOffset]}}if(g!=null){return g}}if(xed_safari){if(xed_selected=="tr"&&l.startContainer){if(l.startContainer.tagName.toLowerCase()=="td"){var u=l.startContainer.parentNode}else{var u=l.startContainer}if(u.tagName.toLowerCase()=="tr"){return u}}if(xed_selected=="tbody"&&l.startContainer){var u=l.startContainer;while(u.tagName.toLowerCase()!=xed_selected){if(!u.parentNode){u=false;break}u=u.parentNode}if(u){return u}}if(xed_selected=="table"&&l.startContainer&&l.endContainer){if(xed_selected_node.tagName.toLowerCase()=="table"){return xed_selected_node}}if(xed_selected_node&&xed_selected_node.tagName.toLowerCase()=="img"){return xed_selected_node}}var u=l.commonAncestorContainer;while(u.nodeType==3){u=u.parentNode}return u}else{if(xed_selected=="a"){if(l.parentElement&&l.parentElement().tagName.toLowerCase()=="img"){g=l.parentElement();return g.parentNode}return l.parentElement?l.parentElement():document.getElementById(m).contentWindow.document.body}if(!l){return document.getElementById(m).contentWindow.document.body}if(l.item){return l.item(0)}return l.parentElement?l.parentElement():document.getElementById(m).contentWindow.document.body}}function xed_get_ancestors(l){if(arguments.length>1){xed_selected=arguments[1]}if(xed_selected){var m=xed_get_parent(l,xed_selected)}else{var m=xed_get_parent(l)}var g=new Array();while(m&&(m.tagName.toLowerCase()!="body")){if(m.nodeType!=1){continue}g.push(m);m=m.parentNode}g.push(document.getElementById(l).contentWindow.document.body);return g}function xed_get_ifname(g){if(xed_safari){xed_selected_node=g}g=(g.ownerDocument)?g.ownerDocument:g;return g.ifname}function xed_event(g){g=(g)?g:((event)?event:null);if(g){var l=(g.target)?g.target:((g.srcElement)?g.srcElement:null);if(l){l=(l.nodeType==1||l.nodeType==9)?l:l.parentNode;ifname=xed_get_ifname(l);if(g.type=="mousemove"){if(xed_msie){xed_mouse_x=g.clientX-document.body.scrollLeft;xed_mouse_y=g.clientY-document.body.scrollTop}else{xed_mouse_x=g.pageX;xed_mouse_y=g.pageY}}else{if(g.type=="mousedown"&&(g.button==0||g.button==1)){xed_update_path(ifname);if(xed_context_menu){xed_toggle_context_menu(ifname,g)}}else{if(g.type=="mousedown"&&(g.button==2||g.button==3)){xed_update_path(ifname);if(xed_msie){g.cancelBubble=true;g.returnValue=false}else{g.cancelBubble=true;g.returnValue=false;g.preventDefault();g.stopPropagation()}return false}else{if(g.type=="contextmenu"){xed_update_path(ifname);xed_toggle_context_menu(ifname,g);if(xed_msie){g.cancelBubble=true;g.returnValue=false}else{g.cancelBubble=true;g.returnValue=false;g.preventDefault();g.stopPropagation()}return false}else{xed_update_path(ifname);k=g.keyCode;if(!xed_msie&&k==0){k=g.charCode}if(g.type=="keypress"){xed_debug("key: "+k);if(k==10||k==13||k==33||k==44||k==46||k==59||k==63){xed_historian(ifname)}else{if(xed_prev_char>31&&(xed_prev_char!=8&&xed_prev_char!=46)&&(k==8||k==46)){xed_historian(ifname)}else{if((xed_prev_char==8||xed_prev_char==46)&&(k!=8&&k!=46)){xed_historian(ifname)}}}xed_prev_char=k}if(g.type=="keydown"&&(k==122||k==90)&&g.ctrlKey){if(g.shiftKey){xed_redo(ifname)}else{xed_undo(ifname)}if(xed_msie){g.cancelBubble=true;g.returnValue=false}else{g.cancelBubble=true;g.returnValue=false;g.preventDefault();g.stopPropagation()}return false}}}}}}}}function xed_add_event(l,g,m){if(xed_msie){l.attachEvent("on"+g,m)}else{l.addEventListener(g,m,true)}}function xed_add_events(l,g,m){for(i=0;i<g.length;i++){xed_add_event(l,g[i],m)}}function xed_update_formatblock(l,g){s=document.getElementById("xed-"+l+"-formatblock");switch(g){case"p":v="<p>";break;case"h1":v="<h1>";break;case"h2":v="<h2>";break;case"h3":v="<h3>";break;case"h4":v="<h4>";break;case"h5":v="<h5>";break;case"h6":v="<h6>";break;case"address":v="<address>";break;case"pre":v="<pre>";break;default:return false}for(i=0;i<s.options.length;i++){if(s.options[i].value==v){s.selectedIndex=i;xed_updated_formatblock=true;break}}}function xed_update_path(m){if(arguments.length>1){xed_selected=arguments[1]}else{xed_selected=false}doc=document.getElementById(m).contentWindow.document;path_div=document.getElementById("xed-"+m+"-path");path_div.innerHTML="";path_div.style.paddingBottom="0px";path_div.style.marginBottom="0px";path=document.createElement("span");try{path.style.cssFloat="left"}catch(A){path.style.styleFloat="right"}path.style.paddingRight="7px";path.style.paddingBottom="0px";path.style.marginBottom="0px";path.innerHTML="Path: ";if(xed_selected){var D=xed_get_ancestors(m,xed_selected)}else{var D=xed_get_ancestors(m)}var g=null;var u=false;var C=false;for(var q=D.length;--q>=0;){g=D[q];if(!g){continue}if(g.tagName.toLowerCase()=="table"){document.getElementById("xed-"+m+"-table-bar").style.display="block";C=true}if(!u){xed_update_formatblock(m,g.tagName.toLowerCase())}var B=document.createElement("a");B.href="#";B.el=g;B.editor=m;B.onclick=function(){this.blur();xed_select_node_contents(this.editor,this.el);return false};var l=g.tagName.toLowerCase();B.title=g.style.cssText;if(g.id){l+="#"+g.id}if(g.className){l+="."+g.className}B.appendChild(document.createTextNode(l));path.appendChild(B);if(q!=0){path.appendChild(document.createTextNode(" "+String.fromCharCode(187)+" "))}}if(!C){document.getElementById("xed-"+m+"-table-bar").style.display="none"}if(l!="body"){edit=document.createElement("a");edit.href="#";edit.el=g;edit.editor=m;edit.onclick=function(){xed_edit_properties(this.editor,this.el);return false};img=document.createElement("img");img.src=xed_path+"/pix/icons/edit-properties.gif";img.alt="Edit Properties";img.title="Edit Properties";img.border="0";edit.appendChild(img);dele=document.createElement("a");dele.href="#";dele.el=g;dele.editor=m;dele.onclick=function(){this.blur();xed_remove_element(this.editor,this.el);document.getElementById(this.editor).contentWindow.focus();return false};img=document.createElement("img");img.src=xed_path+"/pix/icons/remove-element.gif";img.alt="Remove Element";img.title="Remove Element";img.border="0";dele.appendChild(img);path_div.appendChild(path);path_div.appendChild(document.createTextNode(" "));path_div.appendChild(edit);path_div.appendChild(document.createTextNode(" "));path_div.appendChild(dele)}else{path_div.appendChild(path)}}function xed_outer_html(l){outer=l.outerHTML;if(typeof(outer)!="undefined"){return outer}outer="<"+l.tagName;if(l.attributes){for(var g in l.attributes){a=l.attributes[g];if(a.value){outer+=" "+a.name+'="'+a.value+'"'}}}outer+=">";outer+=l.innerHTML;outer+="</"+l.tagName+">";return outer}function xed_remove_element(m,l){xed_historian(m);new_html="";pn=l.parentNode;if(!pn){return false}len=pn.childNodes.length;if(xed_msie){for(var g in l.parentNode.childNodes){if(g>=len){break}n=l.parentNode.childNodes[g];if(n==l){if(l.tagName.toLowerCase()!="xt:box"&&l.tagName.toLowerCase()!="xt:form"){new_html+=l.innerHTML}}else{if(typeof(n)=="function"){}else{if(typeof(n)=="number"){}else{if(typeof(n)=="object"){if(n.outerHTML!==undefined){new_html+=n.outerHTML}else{new_html+=n.data}}}}}}}else{if(xed_safari){for(var g=0;g<l.parentNode.childNodes.length;g++){if(g>=len){break}n=l.parentNode.childNodes[g];if(n==l){if(l.tagName.toLowerCase()!="xt:box"&&l.tagName.toLowerCase()!="xt:form"){new_html+=l.innerHTML}}else{if(typeof(n)=="function"){}else{if(typeof(n)=="number"){}else{if(typeof(n)=="object"){if(n instanceof HTMLElement){new_html+=xed_outer_html(n)}else{new_html+=n.data}}}}}}}else{for(var g in l.parentNode.childNodes){if(g>=len){break}n=l.parentNode.childNodes[g];if(n==l){if(l.tagName.toLowerCase()!="xt:box"&&l.tagName.toLowerCase()!="xt:form"){new_html+=l.innerHTML}}else{if(typeof(n)=="function"){}else{if(typeof(n)=="number"){}else{if(typeof(n)=="object"){if(n instanceof HTMLElement){new_html+=xed_outer_html(n)}else{new_html+=n.data}}}}}}}}l.parentNode.innerHTML=new_html}function xed_strip_base_url(g){if(g.indexOf(xed_site_domain+xed_prefix+"/index/")!=-1){arr=g.split(xed_site_domain+xed_prefix+"/index/");return xed_prefix+"/index/"+arr.pop()}if(g.indexOf(xed_site_domain+xed_prefix+"/pix/")!=-1){arr=g.split(xed_site_domain+xed_prefix+"/pix/");return xed_prefix+"/pix/"+arr.pop()}if(xed_msie){if(g.indexOf(xed_site_domain)!=-1){arr=g.split(xed_site_domain);g=arr.pop()}if(g.indexOf("#")===0){return g}if(g.indexOf("http://")===0){return g}else{if(g.indexOf("www.")===0){return"http://"+g}}return g}var m=xed_site_url;m=m.replace(/[^\/]+$/,"");var l=new RegExp(m);g=g.replace(l,"");m=m.replace(/^(https?:\/\/[^\/]+)(.*)$/,"$1");l=new RegExp(m);return g.replace(l,"")}function xed_get_html(C,l,A){var u="";switch(C.nodeType){case 1:case 11:var B;var q;var F=(C.nodeType==1)?C.tagName.toLowerCase():"";if(F=="box"||F=="form"){F="xt:"+F}if(xed_msie&&F=="head"){if(l){u+="<head>"}var H=RegExp.multiline;RegExp.multiline=true;var m=C.innerHTML.replace(xed_rx_tag_name,function(K,J,I){return J+I.toLowerCase()});RegExp.multiline=H;u+=m;if(l){u+="</head>"}break}else{if(l){B=(!(C.hasChildNodes()||xed_needs_closing_tag(C)));u="<"+F;var G=C.attributes;for(q=0;q<G.length;++q){var D=G.item(q);if(!D.specified){continue}var g=D.nodeName.toLowerCase();if(/_moz|contenteditable|_msh/.test(g)){continue}var E;if(g!="style"){if(typeof C[D.nodeName]!="undefined"&&g!="href"&&g!="src"){E=C.getAttributeNode(D.nodeName).value}else{E=D.nodeValue;if(g=="href"||g=="src"){E=xed_strip_base_url(E)}}}else{E=C.style.cssText}if(/(_moz|^$)/.test(E)){continue}u+=" "+g+'="'+E+'"'}u+=B?" />":">";if(F=="br"){u+="\n"}}}for(q=C.firstChild;q;q=q.nextSibling){u+=xed_get_html(q,true,A)}if(l&&!B){u+="</"+F+">";if(xed_is_block_tag(F)){u+="\n"}}break;case 3:if(!C.previousSibling&&!C.nextSibling&&C.data.match(/^\s*$/i)){u="&nbsp;"}else{u=xed_html_entities(C.data)}break;case 8:u="<!--"+C.data+"-->";break}u=u.replace(/\n\n+/g,"\n\n");return u}function xed_get_source(g){if(xed_edit_state=="edit"){return xed_get_html(document.getElementById(g).contentWindow.document.body,false,false)}return document.getElementById("xed-"+g+"-source").value}function xed_get_anchors(g){html=xed_get_source(g);anchor_list=[];re=/<(h[1-6]).*?>(.+)<\/h[1-6]>/gim;i=0;while(matches=re.exec(html)){href=MD5(matches[1]+matches[2]);anchor_list.push({name:href,value:matches[2]});i++}return anchor_list}function xed_html_entities(g){re=/&/g;g=g.replace(re,"&amp;");re=/</g;g=g.replace(re,"&lt;");re=/>/g;g=g.replace(re,"&gt;");return g}function xed_html_entities_decode(g){orig=g;re=/&quot;/g;g=g.replace(re,'"');re=/&lt;/g;g=g.replace(re,"<");re=/&gt;/g;g=g.replace(re,">");re=/&amp;/g;g=g.replace(re,"&");return g}function xed_url_encode(g){return escape(g)}function xed_parse_uri(g){el=new Object;tmp=g.split("?");el.box=tmp[0];el.args=new Array();if(tmp.length>1){tmp=tmp[1].split("&");for(i=0;i<tmp.length;i++){arg=tmp[i].split("=");el.args.push(xed_attribute(arg[0],arg[1]))}}return el}function xed_insert_html_at_selection(g,l){document.getElementById(g).contentWindow.focus();xed_insert_element(g,"span",[xed_attribute("id","xed-template")]);d=document.getElementById(g).contentWindow.document;m=d.getElementById("xed-template");try{m.innerHTML=l;document.getElementById(g).contentWindow.focus();if(!xed_safari){xed_remove_element(g,m)}}catch(m){}document.getElementById(g).contentWindow.focus()}function xed_insert_node_at_selection(B,u){try{var l=B.getSelection();var A=l.getRangeAt(0);l.removeAllRanges();A.deleteContents();var g=A.startContainer;var G=A.startOffset;A=B.document.createRange();if(g.nodeType==3&&u.nodeType==3){g.insertData(G,u.nodeValue);A.setEnd(g,G+u.length);A.setStart(g,G+u.length)}else{var m;if(g.nodeType==3){var q=g;g=q.parentNode;var H=q.nodeValue;var D=H.substr(0,G);var C=H.substr(G);var F=B.document.createTextNode(D);var m=B.document.createTextNode(C);g.insertBefore(m,q);g.insertBefore(u,m);g.insertBefore(F,u);g.removeChild(q)}else{m=g.childNodes[G];if(typeof(u)=="string"){u=B.document.createTextNode(u)}g.insertBefore(u,m)}A.setEnd(m,0);A.setStart(m,0)}l.addRange(A)}catch(E){try{var A=B.document.selection.createRange();A.collapse(true);A.pasteHTML(u)}catch(E){}}}function xed_debug(g){if(!xed_debug_view){return false}if(xed_msie){document.getElementById("xed-debug-tr").style.display="block"}else{document.getElementById("xed-debug-tr").style.display="table-row"}html=document.getElementById("xed-debug-msg").innerHTML;html=html+"<br />"+g;document.getElementById("xed-debug-msg").innerHTML=html;document.getElementById("xed-debug-msg").scrollTop=document.getElementById("xed-debug-msg").scrollHeight};